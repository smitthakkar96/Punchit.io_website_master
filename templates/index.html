<!DOCTYPE html>
<html>
<head>

  <!-- favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="images/favicon.png" />

  <!--Import Google Icon Font-->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!--Import materialize.css-->
  <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>
  <link type="text/css" rel="stylesheet" href="css/style.css"  media="screen,projection"/>
  <script src="http://js.pusher.com/3.0/pusher.min.js"></script>
  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="theme-color" content="#ff4545"/>

  <style>
  ::-webkit-scrollbar {
    display: none;
  }
  ::-moz-scrollbar {
    display: none;
  }
  ::scrollbar {
    display: none;
  }

  </style>

</head>

<body cz-shortcut-listen="true" ng-app="app">
  <!--Import jQuery before materialize.js-->
  <script src="js/jquery-2.1.1.min.js" type="text/javascript"></script>
  <script type="text/javascript" src="js/materialize.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
  <script type="text/javascript" src="js/app.js"></script>
  <script type="text/javascript" src="js/controllers.js"></script>
  <script type="text/javascript" src="js/factory.js"></script>
  <script src="/js/JIC.js"></script>

  <script src="https://www.parsecdn.com/js/parse-1.6.12.min.js"></script>

  <div class="navbar-fixed row" ng-controller="myCtrl">
    <ul class="side-nav collection" id="mobile-demo" style="color:#ff4545">

      <li class="collection-item"><center><img ng-src="{a ProfilePicture_url a}" style="height:100px;width:100px;border:2px solid #ff4545" class="circle animated infinite bounce"/>
        <br/><b style="color:#ff4545">{a Name a}</b></center>
      </li>
      <li class="card" style="border-radius:2px;width:80%;margin-left:20px">
        <input type="text" placeholder="search" style="width:80%;color:red;" ng-model="Value"/>
      </li>
      <li>
        <a href="/Settings">Edit Profile</a>
      </li>
      <li>
        <a href="/logout">Logout</a>
      </li>
    </ul>

    <nav style="background-color:#ff4545">
      <div class="nav-wrapper row">
        <div>
          <a href="/" class="brand-logo center responsive-img"><img src="images/logo.png" style="margin-top:5px;height:50px;width:inherit"/></a>
          <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">menu</i></a>
        </div>
        <div class="right hide-on-med-and-down">
          <div class="row">

            <div class="col l12 s12">

              <!--<div class="chip">
              <div class="chip">
              <img src="http://www.voritos.com/wp-content/uploads/2015/01/taylor_swift_best_hd_image.jpg" alt="Contact Person">
              Jane Doe
            </div>-->
            <div class="right">
              <div class="row">
                <!--
                <div class="col">
                <a class='dropdown-button' data-beloworigin='true' href='#' data-activates='dropdown2'>
                <i class="material-icons">notifications</i>
              </a>
              <ul id='dropdown2' class='dropdown-content collection' style="width:300px;margin-top:80px;background-color:rgba(255,255,255,1);">
              <li class="collection-item"><p>sxssxssxsccsccdcdccnskcndkscnlkdjcndskjcnsdkjcnsdkcjnsc</p></li>
            </ul>

          </div>
        -->
        <div class="col">
          <a class='dropdown-button' data-beloworigin='true' href='#' data-activates='dropdown1'>
            <div class="chip" href="/Profile" style="margin-top:15px;width:120px;">
              <img ng-src="{a ProfilePicture_url a}" class="profile-img responsive-img" style="height:inherit;">
              <font class="center">{a Name a}</font>
            </div>
          </a>
          <ul id='dropdown1' class='dropdown-content right' style="margin-top:13px;background-color:rgba(255,255,255,0);">
            <li><a href="/Profile" style="color:#ff4545"><i class="material-icons">person_outline</i>My profile</li>
              <li class="divider"></li>
              <li><a href="/Settings" style="color:#ff4545"><i class="material-icons">format_quote</i>Settings</li>
                <li class="divider"></li>
                <li><a href="/logout" style="color:#ff4545"><i class="material-icons">power_settings_new</i>Logout</a></li>
                <li class="divider"></li>
              </ul>
            </div>
          </div>
        </div>


      </div>
    </div>
  </div>
  <div class="left row hide-on-med-and-down">
    <form class="col s12">
      <div class="input-field col s12">
        <input type="search" style="background-color:rgba(255,255,255,255,0);color:#fff;" ng-model="Value" class="field">
        <label for="search-field"><i class="mdi-action-search"></i></label>
        <i class="mdi-navigation-close close"></i>
      </div>
    </form>
  </div>
</div>

</nav>
</div>
<div class="container" ng-controller="bodyCtrl">
  <!--<div id="fullpage">-->

  <div class="row" style="position:fixed;z-index:2;" id="newPunches">
    <div class="col s12">
      <center>
        <a href="#"><img src="images/new_punches.png"/></a>
      </center>
    </div>
  </div>

  <center>
    <div class="section card col l8 s12" style="width:{a width a};" id="main_card" ng-repeat="SinglePost in posts track by $index" ng-hide="{a PostsVisibility a}">
      <div class="card-content content">
        <div class="row">
          <div class="col s12">
            <center class="row">
              <img class="circle responsive-img col s6" ng-src="{a SinglePost.get('By').get('ProfilePicture').url() a}" style="height: 50px;width:74px"/>


              <span class="col s6" style="margin-top:15px;">
                <a href="/Profile?id={a SinglePost.get('By').id a}" style="color:red;float:left">{a SinglePost.get('By').get('Ninja_name') a}</a>
              </span>


              <span style="float:right;color:grey;margin-top:15px;margin-right:1%;" class="s10">
                {a SinglePost.get('TimeStamp') a}
              </span>
            </center>

          </div>

          <!-- Post Question -->
          <div style="margin-top:1%;" class="col s12 center">
            <center>
              <p style="color:#989489;font-size:18px;overflow:hidden">{a SinglePost.get('Title') a}</p>
            </center>
          </div>
        </div>
      </div>

      <!-- Post images -->
      <div class="card-image" style="margin-left: 1%; margin-top:-2%;">
        <div class="row">

          <div id="post_img1" class="col  waves-effect waves-light" style="margin-left:3%; border:1px solid #989489;float:left;margin-right:2%;width:45%;padding:10px;height:400px;background-image:url('images/background2.jpg');background-size:330px 500px;background-repeat:no-repeat;">
            <img class="responsive-img right" src="images/post_tick.png" style="margin-top:-6.5%;left:22px;height:70px; width:70px;z-index:1;display:{a SinglePost.get('isVoted1') a}"/>
            <a ng-click="Punch($index,1)"><img class="responsive-img" ng-src="{a SinglePost.get('Image1').url() a}" style="width: 100%;height: 100%;object-fit: contain; max-height:100%;position:absolute;top: 50%;left: 50%;transform: translateX(-50%) translateY(-50%);max-width: 100%;max-height: 100%;"></a>
          </div>
          <div id="post_img2" class="col waves-effect waves-light" style="margin-left:1%;border:1px solid #989489;width:45%;padding:10px;height:400px;background-image:url('images/mirror_background2.jpg');background-size:330px 500px;background-repeat:no-repeat;">
            <img class="responsive-img right" src="images/post_tick.png" style="margin-top:-7%;left:22px;height:70px; width:70px;z-index:1;display:{a SinglePost.get('isVoted2') a}"/>
            <a ng-click="Punch($index,2)"><img class="responsive-img" ng-src="{a SinglePost.get('Image2').url() a}" style="width: 100%;height: 100%;object-fit: contain; max-height:100%;position:absolute;top: 50%;left: 50%;transform: translateX(-50%) translateY(-50%);max-width: 100%;max-height: 100%;"></a>
          </div>

        </div>
      </div>
      <div class="card-content" style="margin-top:-5%;">
        <div class="row">
          <div class="col s6">
            <p style="text-align:center;font-size:100%;color:#ff4545">{a SinglePost.get('Image1Title') a}</p>
            <div style="background-color:#ff4545;color: #ff4545;height:1px;"><hr noshade="noshade" style="border:0px"/></div>
            <div style="border:1px;"><p style="text-align:center;font-size:100%;color:red;padding-top:1%">{a SinglePost.get('Punchers1').length a}</p></div>
          </div>
          <div class="col s6">
            <p style="text-align:center;font-size:100%;color:#ff4545">{a SinglePost.get('Image2Title') a}</p>
            <div style="background-color:#ff4545;color:#ff4545;height:1px;"><hr noshade="noshade" style="border:0px"/></div>
            <center style="font-size:100%;color:#ff4545;padding-top:1%"><div style="width:15%;">{a SinglePost.get('Punchers2').length a}</div></center>
          </div>

        </div>
      </div>

      <!-- share comment icons -->
      <div class="row" style="margin-top:-5%">
        <div class="col s2 l1">
          <a href="" class="modal-trigger"><img src="images/comment.png" style="height:inherit;width:70px;margin-left:10px;" id="comment" ng-click="openComment($index)"></a>
        </div>
        <div class="col s2 l1">
          <a href="#" class="dropdown-button" data-activates='share'><img src="images/share.png" style="margin-left:7px;height:inherit;width:70px;" id="share_btn"></a>
          <ul id='share' class='dropdown-content'>
            <li><a href="#!"><img src="https://www.facebook.com/images/fb_icon_325x325.png" style="margin-left:14px;height:inherit;width:70px;margin-top:11px;width:44px" id="FACEBOOK"></a></li>
            <li><a href="#!"><img src="http://health.uri.edu/files/twitter.png" style="margin-left:14px;height:inherit;width:70px;margin-top:11px;width:44px" id="Twitter"></a></li>
        </ul>
        </div>
      </div>
    </div>
  </center>

  <!-- #############################Load more##########################################  -->
  <div class="col l12" id="spinner">
    <center>
      <img src="images/spinner.gif"/>
    </center>
  </div>
  <div class="col l12" id="LoadMore">
    <center><a ng-click="LoadMore()"><img src="images/LoadMore.png" style="height:100px"/></a><center>
    </div>
    <div id="modal1" class="modal modal-fixed-footer" style="overflow:hidden;">
      <div class="modal-content">

        <!-- show when no comments -->
        <center ng-show="youFirst"><label id="no_comment">No comments. Be the first one to comment.</label></center>

        <ul class="collection">
          <li class="collection-item avatar" ng-repeat="comment in comments">
            <img ng-src="{a comment.get('User').get('ProfilePicture').url() a}" alt="" class="circle" style="border:1px solid #ff4545;">
            <span class="title"><a href="/Profile?id={a comment.get('User').id a}"><b style="color:#ff4545">{a comment.get('User').get('Ninja_name') a}</b></a></span>
            <p class="commentText">{a comment.get("comment") a}<br>
            </p>
          </li>
        </ul>

        <div class="preloader-wrapper big active" style="margin-left:50%;display:none">
          <div class="spinner-layer spinner-red-only">
            <div class="circle-clipper left">
              <div class="circle"></div>
            </div><div class="gap-patch">
              <div class="circle"></div>
            </div><div class="circle-clipper right">
              <div class="circle"></div>
            </div>
          </div>
        </div>

        <div class="col l12">
          <a><img src="images/LoadMore.png" style="margin-left:40%;width:25%;height:inherit;display:none"/></a>
        </div>
      </div>
      <div class="modal-footer" style="height:110px;overflow:auto;">
        <div class="row">
          <div class="col l12 s12">
            <div class="input-field col l10 s9">
              <label for="textarea1">Enter a Comment...</label>
              <textarea id="textarea1" class="materialize-textarea" style="margin-bottom:5px;color:#ff4545;margin-right:10px;padding:0;" ng-model="cc" my-enter="Enter(true)"></textarea>
            </div>
            <div class="col l2 s2">
              <a class="waves-effect waves-light btn" style="background-color:#ff4545;" ng-click="PostComment()"><i class="material-icons">comment</i></a>
            </div>
            <div class="col l12">
              <input type="checkbox" class="filled-in" id="filled-in-box" checked="checked" style="margin-top:5px;"/>
              <label for="filled-in-box">Enter to send.</label>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!--        </div>-->
</body>
<script type="text/javascript">
$(function(){
  
  var isloggingInForFirstTime = $.("authCookie")
  if(isloggingInForFirstTime){
  location.reload();
  $.removeCookie("authCookie")
  }
  $(".button-collapse").sideNav();
  $('.modal-trigger').leanModal();
  $('#textarea1').trigger('autoresize');

  //alert(1);
  /*
  var width=$(window).width();
  alert(width);

  if($(window).width())<800){
  $("#post_img1").css("height",400);
  $("#post_img2").css("height",400);
}else if($(window).width())<500){
$("#post_img1").css("height",300);
$("#post_img2").css("height",300);
}else if($(window).width())<300){
$("#post_img1").css("height",200);
$("#post_img2").css("height",200);
}
alert(1);
alert("post_img1 : "+($("#post_img1").height())+"\npost_img2 : "+($("#post_img2").height()));

$(window).resize(function(){
if($(window).width())<800){
$("#post_img1").css("height",400);
$("#post_img2").css("height",400);
}else if($(window).width())<500){
$("#post_img1").css("height",300);
$("#post_img2").css("height",300);
}else if($(window).width())<300){
$("#post_img1").css("height",200);
$("#post_img2").css("height",200);
}
});
*/

function unescapeHtml(text) {
  return text.replace(/&amp;/g, '&')
  .replace(/&lt;/g, '<')
  .replace(/&gt;/g, '>')
  .replace(/&quot;/g, '"')
  .replace(/&#039;/g, "'");
}
$(function(){

  var shortenP = function(options) {
    options = $.extend({
      length: 160,
      ellipsis: ' [...]',
      moreClass: 'more-link',
      moreText: 'Read More'
    }, options);
    $('.commentText').each(function() {
      var $p = $(this);
      var text = $p.html();
      var shortString = text.substring(0, options.length) + options.ellipsis;
      $p.data('fulltext', text);
      $p.html(unescapeHtml(shortString));
      $('<a/>').attr({
        href: '#',
        'class': options.moreClass
      }).html(options.moreText).
      insertAfter($p);
      $p.next().click(function(e) {

        $p.html($p.data('fulltext'));
        e.preventDefault();
        $(this).hide();
      });

    });

  };

  shortenP();
  swapC()
  $('#wait').hide()

  $("#Image1").change(function(){
    readURL(this,1);
  });
  $("#Image2").change(function(){
    readURL(this,2);
  });

})
function readURL(input,ot) {
  if (input.files && input.files[0]) {
    var reader = new FileReader();

    reader.onload = function (e) {
      if(ot==1)
      $('#Preview1').attr('src', e.target.result);
      else
      $('#Preview2').attr('src', e.target.result);
    }

    reader.readAsDataURL(input.files[0]);
  }
}
var dataSrc = ["Technology","Movies","Sports","News","Mens"];
var colors = ['#c5cae9','#bbdefb','#c8e6e9','#fff9c4','#ffe0b2','#ffe0b2','#ffcdd2']
var cPos = 0

function swapC() {
  $( "<style>.rainbow {background : "+colors[cPos]+"}</style>" ).appendTo( "head" )
  //    $('.rainbow').toggle()
  //$('#Punch').animate({ "background":colors[cPos] }, 500)
  cPos++
  if (cPos == colors.length) {
    cPos = 0
  }
  window.setTimeout(function() { swapC() }, 500)
}
function punchit(){
  $('#wait').show()
  window.setTimeout(function(){$('#PunchModel').closeModal()},5000)
}
});
</script>
<div ng-controller="CreatePunch" style="overflow-y: auto;max-height:40px" id="CreatePunch">
  <div class="fixed-action-btn" style="bottom: 45px; right: 44px;">
    <a class="btn-floating btn-large waves-effect waves-light btn modal-trigger" style="background-color:#ff4545" id="Punch" href="#PunchModel">
      <!--<img src="images/FloatingPunch1.png" style="height:inherit;width:inherit"/>-->
      <i class="material-icons">add</i>
    </a>
  </div>
  <div id="PunchModel" class="modal">
    <form>
      <div class="modal-content">
        <div class="row">
          <div class="col s12">
            <input type="text" placeholder="Title" class="textcenter" ng-model="Title"  wm-block-length="validLength" wm-block>
          </div>
          <div class="col s12">
            <div class="row">
              <div class="col s6">
                <div class="file-field input-field">
                  <div class="" style="height:inherit;width:100%">
                    <center>
                      <img src="images/kitkat.png" class="responsive-img" id="Preview1" style="" />
                    </center>
                    <input type="file" id="Image1">
                  </div>
                </div>
              </div>
              <div class="col s6">
                <div class="file-field input-field">
                  <div class="" style="width:100%">
                    <center>
                      <img src="images/lolipop.png" class="responsive-img" style="" id="Preview2"/>
                    </center>
                    <input type="file" id="Image2">
                  </div>
                </div>
              </div>

            </div>
          </div>
          <div class="col s12">
            <div class="row">
              <div class="col s6">
                <input type="text" class="ImgTitle textcenter" placeholder="Title1" ng-model="Image1Title" wm-block-length="validTitleLength" wm-block>
              </div>
              <div class="col s6">
                <input type="text" class="ImgTitle textcenter" placeholder="Title2" ng-model="Image2Title" wm-block-length="validTitleLength" wm-block>
              </div>
            </div>
          </div>
          <div class="col s12" style="background-color:white">
            <div class="col s5" ng-repeat="i in Interests">
              <p>
             <input type="checkbox" class="Interests" value="{a i a}" id="{a i a}"/>
             <label for="{a i a}">{a i a}</label>
            </p>
            </div>
          </div>
          <div class="col s12">
            <div class="row" style="margin-top:1%;">
              <center>
                <div class="col l12 s12">
                  <center>
                    <a id="createpunch_btn"class="waves-effect waves-light btn" style="width:40%;height:inherit;background-color:#ff4545;" ng-click="punchit()">Punch It</a>
                  </center>
                </div>
              </center>
              <div class="col l1 s12 center" id="wait" style="margin-right:10px;">

                <div class="preloader-wrapper active">
                  <div class="spinner-layer spinner-blue-only">
                    <div class="circle-clipper left">
                      <div class="circle"></div>
                    </div><div class="gap-patch">
                      <div class="circle"></div>
                    </div><div class="circle-clipper right">
                      <div class="circle"></div>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    </form>
</div>

<script>

if($(window).width()<1000){
  $("#createpunch_btn").css("width","100%");
  alert()
  $("#post_img1").css("height","300px")
  $("#post_img2").css("height","300px")
}
$(function(){
  $('#newPunches').click(function(){
    $('#newPunches').hide()
  });
    $('.dropdown-button').dropdown({
      inDuration: 300,
      outDuration: 225,
      constrain_width: false, // Does not change width of dropdown to that of the activator
      hover: true, // Activate on hover
      gutter: 0, // Spacing from edge
      belowOrigin: false, // Displays dropdown below the button
      alignment: 'left' // Displays dropdown with edge aligned to the left of button
    }
  );
})
</script>

<style>
.profile-img
{
  border-radius: 50%;
}
.textcenter
{
  text-align:center;
}
.ImgTitle
{
  height: 25px
}
.fit-center{
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translateX(-50%) translateY(-50%);
  max-width: 100%;
  max-height: 100%;
}
</style>
</html>
